"use strict";var Ts=Object.create;var ve=Object.defineProperty;var vs=Object.getOwnPropertyDescriptor;var xs=Object.getOwnPropertyNames;var ws=Object.getPrototypeOf,Ns=Object.prototype.hasOwnProperty;var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Cs=(r,e)=>{for(var t in e)ve(r,t,{get:e[t],enumerable:!0})},qt=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of xs(e))!Ns.call(r,s)&&s!==t&&ve(r,s,{get:()=>e[s],enumerable:!(n=vs(e,s))||n.enumerable});return r};var H=(r,e,t)=>(t=r!=null?Ts(ws(r)):{},qt(e||!r||!r.__esModule?ve(t,"default",{value:r,enumerable:!0}):t,r)),Rs=r=>qt(ve({},"__esModule",{value:!0}),r);var ce=m((_c,rr)=>{var Os="2.0.0",As=Number.MAX_SAFE_INTEGER||9007199254740991,$s=16,Ls=250,Ps=["major","premajor","minor","preminor","patch","prepatch","prerelease"];rr.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:$s,MAX_SAFE_BUILD_LENGTH:Ls,MAX_SAFE_INTEGER:As,RELEASE_TYPES:Ps,SEMVER_SPEC_VERSION:Os,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var le=m((Vc,nr)=>{var ks=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};nr.exports=ks});var J=m((k,sr)=>{var{MAX_SAFE_COMPONENT_LENGTH:et,MAX_SAFE_BUILD_LENGTH:qs,MAX_LENGTH:Us}=ce(),_s=le();k=sr.exports={};var Vs=k.re=[],Fs=k.safeRe=[],p=k.src=[],f=k.t={},js=0,tt="[a-zA-Z0-9-]",Ms=[["\\s",1],["\\d",Us],[tt,qs]],Gs=r=>{for(let[e,t]of Ms)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},g=(r,e,t)=>{let n=Gs(e),s=js++;_s(r,s,e),f[r]=s,p[s]=e,Vs[s]=new RegExp(e,t?"g":void 0),Fs[s]=new RegExp(n,t?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*");g("NUMERICIDENTIFIERLOOSE","\\d+");g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${tt}*`);g("MAINVERSION",`(${p[f.NUMERICIDENTIFIER]})\\.(${p[f.NUMERICIDENTIFIER]})\\.(${p[f.NUMERICIDENTIFIER]})`);g("MAINVERSIONLOOSE",`(${p[f.NUMERICIDENTIFIERLOOSE]})\\.(${p[f.NUMERICIDENTIFIERLOOSE]})\\.(${p[f.NUMERICIDENTIFIERLOOSE]})`);g("PRERELEASEIDENTIFIER",`(?:${p[f.NUMERICIDENTIFIER]}|${p[f.NONNUMERICIDENTIFIER]})`);g("PRERELEASEIDENTIFIERLOOSE",`(?:${p[f.NUMERICIDENTIFIERLOOSE]}|${p[f.NONNUMERICIDENTIFIER]})`);g("PRERELEASE",`(?:-(${p[f.PRERELEASEIDENTIFIER]}(?:\\.${p[f.PRERELEASEIDENTIFIER]})*))`);g("PRERELEASELOOSE",`(?:-?(${p[f.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${p[f.PRERELEASEIDENTIFIERLOOSE]})*))`);g("BUILDIDENTIFIER",`${tt}+`);g("BUILD",`(?:\\+(${p[f.BUILDIDENTIFIER]}(?:\\.${p[f.BUILDIDENTIFIER]})*))`);g("FULLPLAIN",`v?${p[f.MAINVERSION]}${p[f.PRERELEASE]}?${p[f.BUILD]}?`);g("FULL",`^${p[f.FULLPLAIN]}$`);g("LOOSEPLAIN",`[v=\\s]*${p[f.MAINVERSIONLOOSE]}${p[f.PRERELEASELOOSE]}?${p[f.BUILD]}?`);g("LOOSE",`^${p[f.LOOSEPLAIN]}$`);g("GTLT","((?:<|>)?=?)");g("XRANGEIDENTIFIERLOOSE",`${p[f.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);g("XRANGEIDENTIFIER",`${p[f.NUMERICIDENTIFIER]}|x|X|\\*`);g("XRANGEPLAIN",`[v=\\s]*(${p[f.XRANGEIDENTIFIER]})(?:\\.(${p[f.XRANGEIDENTIFIER]})(?:\\.(${p[f.XRANGEIDENTIFIER]})(?:${p[f.PRERELEASE]})?${p[f.BUILD]}?)?)?`);g("XRANGEPLAINLOOSE",`[v=\\s]*(${p[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[f.XRANGEIDENTIFIERLOOSE]})(?:${p[f.PRERELEASELOOSE]})?${p[f.BUILD]}?)?)?`);g("XRANGE",`^${p[f.GTLT]}\\s*${p[f.XRANGEPLAIN]}$`);g("XRANGELOOSE",`^${p[f.GTLT]}\\s*${p[f.XRANGEPLAINLOOSE]}$`);g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${et}})(?:\\.(\\d{1,${et}}))?(?:\\.(\\d{1,${et}}))?`);g("COERCE",`${p[f.COERCEPLAIN]}(?:$|[^\\d])`);g("COERCEFULL",p[f.COERCEPLAIN]+`(?:${p[f.PRERELEASE]})?(?:${p[f.BUILD]})?(?:$|[^\\d])`);g("COERCERTL",p[f.COERCE],!0);g("COERCERTLFULL",p[f.COERCEFULL],!0);g("LONETILDE","(?:~>?)");g("TILDETRIM",`(\\s*)${p[f.LONETILDE]}\\s+`,!0);k.tildeTrimReplace="$1~";g("TILDE",`^${p[f.LONETILDE]}${p[f.XRANGEPLAIN]}$`);g("TILDELOOSE",`^${p[f.LONETILDE]}${p[f.XRANGEPLAINLOOSE]}$`);g("LONECARET","(?:\\^)");g("CARETTRIM",`(\\s*)${p[f.LONECARET]}\\s+`,!0);k.caretTrimReplace="$1^";g("CARET",`^${p[f.LONECARET]}${p[f.XRANGEPLAIN]}$`);g("CARETLOOSE",`^${p[f.LONECARET]}${p[f.XRANGEPLAINLOOSE]}$`);g("COMPARATORLOOSE",`^${p[f.GTLT]}\\s*(${p[f.LOOSEPLAIN]})$|^$`);g("COMPARATOR",`^${p[f.GTLT]}\\s*(${p[f.FULLPLAIN]})$|^$`);g("COMPARATORTRIM",`(\\s*)${p[f.GTLT]}\\s*(${p[f.LOOSEPLAIN]}|${p[f.XRANGEPLAIN]})`,!0);k.comparatorTrimReplace="$1$2$3";g("HYPHENRANGE",`^\\s*(${p[f.XRANGEPLAIN]})\\s+-\\s+(${p[f.XRANGEPLAIN]})\\s*$`);g("HYPHENRANGELOOSE",`^\\s*(${p[f.XRANGEPLAINLOOSE]})\\s+-\\s+(${p[f.XRANGEPLAINLOOSE]})\\s*$`);g("STAR","(<|>)?=?\\s*\\*");g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Re=m((Fc,ir)=>{var Hs=Object.freeze({loose:!0}),Xs=Object.freeze({}),Bs=r=>r?typeof r!="object"?Hs:r:Xs;ir.exports=Bs});var rt=m((jc,cr)=>{var or=/^[0-9]+$/,ar=(r,e)=>{let t=or.test(r),n=or.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},Ws=(r,e)=>ar(e,r);cr.exports={compareIdentifiers:ar,rcompareIdentifiers:Ws}});var w=m((Mc,pr)=>{var Ie=le(),{MAX_LENGTH:lr,MAX_SAFE_INTEGER:De}=ce(),{safeRe:ur,t:dr}=J(),zs=Re(),{compareIdentifiers:Q}=rt(),nt=class r{constructor(e,t){if(t=zs(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>lr)throw new TypeError(`version is longer than ${lr} characters`);Ie("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?ur[dr.LOOSE]:ur[dr.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>De||this.major<0)throw new TypeError("Invalid major version");if(this.minor>De||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>De||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let i=+s;if(i>=0&&i<De)return i}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Ie("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Q(this.major,e.major)||Q(this.minor,e.minor)||Q(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],s=e.prerelease[t];if(Ie("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Q(n,s)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],s=e.build[t];if(Ie("build compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Q(n,s)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let s=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(t){let i=[t,s];n===!1&&(i=[t]),Q(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};pr.exports=nt});var X=m((Gc,hr)=>{var fr=w(),Ks=(r,e,t=!1)=>{if(r instanceof fr)return r;try{return new fr(r,e)}catch(n){if(!t)return null;throw n}};hr.exports=Ks});var gr=m((Hc,mr)=>{var Ys=X(),Js=(r,e)=>{let t=Ys(r,e);return t?t.version:null};mr.exports=Js});var yr=m((Xc,Er)=>{var Qs=X(),Zs=(r,e)=>{let t=Qs(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};Er.exports=Zs});var xr=m((Bc,vr)=>{var Tr=w(),ei=(r,e,t,n,s)=>{typeof t=="string"&&(s=n,n=t,t=void 0);try{return new Tr(r instanceof Tr?r.version:r,t).inc(e,n,s).version}catch{return null}};vr.exports=ei});var Cr=m((Wc,Nr)=>{var wr=X(),ti=(r,e)=>{let t=wr(r,null,!0),n=wr(e,null,!0),s=t.compare(n);if(s===0)return null;let i=s>0,o=i?t:n,a=i?n:t,c=!!o.prerelease.length;if(!!a.prerelease.length&&!c)return!a.patch&&!a.minor?"major":o.patch?"patch":o.minor?"minor":"major";let u=c?"pre":"";return t.major!==n.major?u+"major":t.minor!==n.minor?u+"minor":t.patch!==n.patch?u+"patch":"prerelease"};Nr.exports=ti});var Ir=m((zc,Rr)=>{var ri=w(),ni=(r,e)=>new ri(r,e).major;Rr.exports=ni});var Sr=m((Kc,Dr)=>{var si=w(),ii=(r,e)=>new si(r,e).minor;Dr.exports=ii});var Or=m((Yc,br)=>{var oi=w(),ai=(r,e)=>new oi(r,e).patch;br.exports=ai});var $r=m((Jc,Ar)=>{var ci=X(),li=(r,e)=>{let t=ci(r,e);return t&&t.prerelease.length?t.prerelease:null};Ar.exports=li});var S=m((Qc,Pr)=>{var Lr=w(),ui=(r,e,t)=>new Lr(r,t).compare(new Lr(e,t));Pr.exports=ui});var qr=m((Zc,kr)=>{var di=S(),pi=(r,e,t)=>di(e,r,t);kr.exports=pi});var _r=m((el,Ur)=>{var fi=S(),hi=(r,e)=>fi(r,e,!0);Ur.exports=hi});var Se=m((tl,Fr)=>{var Vr=w(),mi=(r,e,t)=>{let n=new Vr(r,t),s=new Vr(e,t);return n.compare(s)||n.compareBuild(s)};Fr.exports=mi});var Mr=m((rl,jr)=>{var gi=Se(),Ei=(r,e)=>r.sort((t,n)=>gi(t,n,e));jr.exports=Ei});var Hr=m((nl,Gr)=>{var yi=Se(),Ti=(r,e)=>r.sort((t,n)=>yi(n,t,e));Gr.exports=Ti});var ue=m((sl,Xr)=>{var vi=S(),xi=(r,e,t)=>vi(r,e,t)>0;Xr.exports=xi});var be=m((il,Br)=>{var wi=S(),Ni=(r,e,t)=>wi(r,e,t)<0;Br.exports=Ni});var st=m((ol,Wr)=>{var Ci=S(),Ri=(r,e,t)=>Ci(r,e,t)===0;Wr.exports=Ri});var it=m((al,zr)=>{var Ii=S(),Di=(r,e,t)=>Ii(r,e,t)!==0;zr.exports=Di});var Oe=m((cl,Kr)=>{var Si=S(),bi=(r,e,t)=>Si(r,e,t)>=0;Kr.exports=bi});var Ae=m((ll,Yr)=>{var Oi=S(),Ai=(r,e,t)=>Oi(r,e,t)<=0;Yr.exports=Ai});var ot=m((ul,Jr)=>{var $i=st(),Li=it(),Pi=ue(),ki=Oe(),qi=be(),Ui=Ae(),_i=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return $i(r,t,n);case"!=":return Li(r,t,n);case">":return Pi(r,t,n);case">=":return ki(r,t,n);case"<":return qi(r,t,n);case"<=":return Ui(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Jr.exports=_i});var Zr=m((dl,Qr)=>{var Vi=w(),Fi=X(),{safeRe:$e,t:Le}=J(),ji=(r,e)=>{if(r instanceof Vi)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?$e[Le.COERCEFULL]:$e[Le.COERCE]);else{let c=e.includePrerelease?$e[Le.COERCERTLFULL]:$e[Le.COERCERTL],l;for(;(l=c.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||l.index+l[0].length!==t.index+t[0].length)&&(t=l),c.lastIndex=l.index+l[1].length+l[2].length;c.lastIndex=-1}if(t===null)return null;let n=t[2],s=t[3]||"0",i=t[4]||"0",o=e.includePrerelease&&t[5]?`-${t[5]}`:"",a=e.includePrerelease&&t[6]?`+${t[6]}`:"";return Fi(`${n}.${s}.${i}${o}${a}`,e)};Qr.exports=ji});var tn=m((pl,en)=>{var at=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let s=this.map.keys().next().value;this.delete(s)}this.map.set(e,t)}return this}};en.exports=at});var b=m((fl,on)=>{var ct=class r{constructor(e,t){if(t=Gi(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof lt)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(s=>!nn(s[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let s of this.set)if(s.length===1&&Yi(s[0])){this.set=[s];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&zi)|(this.options.loose&&Ki))+":"+e,s=rn.get(n);if(s)return s;let i=this.options.loose,o=i?I[C.HYPHENRANGELOOSE]:I[C.HYPHENRANGE];e=e.replace(o,oo(this.options.includePrerelease)),y("hyphen replace",e),e=e.replace(I[C.COMPARATORTRIM],Xi),y("comparator trim",e),e=e.replace(I[C.TILDETRIM],Bi),y("tilde trim",e),e=e.replace(I[C.CARETTRIM],Wi),y("caret trim",e);let a=e.split(" ").map(d=>Ji(d,this.options)).join(" ").split(/\s+/).map(d=>io(d,this.options));i&&(a=a.filter(d=>(y("loose invalid filter",d,this.options),!!d.match(I[C.COMPARATORLOOSE])))),y("range list",a);let c=new Map,l=a.map(d=>new lt(d,this.options));for(let d of l){if(nn(d))return[d];c.set(d.value,d)}c.size>1&&c.has("")&&c.delete("");let u=[...c.values()];return rn.set(n,u),u}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>sn(n,t)&&e.set.some(s=>sn(s,t)&&n.every(i=>s.every(o=>i.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Hi(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(ao(this.set[t],e,this.options))return!0;return!1}};on.exports=ct;var Mi=tn(),rn=new Mi,Gi=Re(),lt=de(),y=le(),Hi=w(),{safeRe:I,t:C,comparatorTrimReplace:Xi,tildeTrimReplace:Bi,caretTrimReplace:Wi}=J(),{FLAG_INCLUDE_PRERELEASE:zi,FLAG_LOOSE:Ki}=ce(),nn=r=>r.value==="<0.0.0-0",Yi=r=>r.value==="",sn=(r,e)=>{let t=!0,n=r.slice(),s=n.pop();for(;t&&n.length;)t=n.every(i=>s.intersects(i,e)),s=n.pop();return t},Ji=(r,e)=>(y("comp",r,e),r=eo(r,e),y("caret",r),r=Qi(r,e),y("tildes",r),r=ro(r,e),y("xrange",r),r=so(r,e),y("stars",r),r),R=r=>!r||r.toLowerCase()==="x"||r==="*",Qi=(r,e)=>r.trim().split(/\s+/).map(t=>Zi(t,e)).join(" "),Zi=(r,e)=>{let t=e.loose?I[C.TILDELOOSE]:I[C.TILDE];return r.replace(t,(n,s,i,o,a)=>{y("tilde",r,n,s,i,o,a);let c;return R(s)?c="":R(i)?c=`>=${s}.0.0 <${+s+1}.0.0-0`:R(o)?c=`>=${s}.${i}.0 <${s}.${+i+1}.0-0`:a?(y("replaceTilde pr",a),c=`>=${s}.${i}.${o}-${a} <${s}.${+i+1}.0-0`):c=`>=${s}.${i}.${o} <${s}.${+i+1}.0-0`,y("tilde return",c),c})},eo=(r,e)=>r.trim().split(/\s+/).map(t=>to(t,e)).join(" "),to=(r,e)=>{y("caret",r,e);let t=e.loose?I[C.CARETLOOSE]:I[C.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(s,i,o,a,c)=>{y("caret",r,s,i,o,a,c);let l;return R(i)?l="":R(o)?l=`>=${i}.0.0${n} <${+i+1}.0.0-0`:R(a)?i==="0"?l=`>=${i}.${o}.0${n} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.0${n} <${+i+1}.0.0-0`:c?(y("replaceCaret pr",c),i==="0"?o==="0"?l=`>=${i}.${o}.${a}-${c} <${i}.${o}.${+a+1}-0`:l=`>=${i}.${o}.${a}-${c} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.${a}-${c} <${+i+1}.0.0-0`):(y("no pr"),i==="0"?o==="0"?l=`>=${i}.${o}.${a}${n} <${i}.${o}.${+a+1}-0`:l=`>=${i}.${o}.${a}${n} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.${a} <${+i+1}.0.0-0`),y("caret return",l),l})},ro=(r,e)=>(y("replaceXRanges",r,e),r.split(/\s+/).map(t=>no(t,e)).join(" ")),no=(r,e)=>{r=r.trim();let t=e.loose?I[C.XRANGELOOSE]:I[C.XRANGE];return r.replace(t,(n,s,i,o,a,c)=>{y("xRange",r,n,s,i,o,a,c);let l=R(i),u=l||R(o),d=u||R(a),E=d;return s==="="&&E&&(s=""),c=e.includePrerelease?"-0":"",l?s===">"||s==="<"?n="<0.0.0-0":n="*":s&&E?(u&&(o=0),a=0,s===">"?(s=">=",u?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):s==="<="&&(s="<",u?i=+i+1:o=+o+1),s==="<"&&(c="-0"),n=`${s+i}.${o}.${a}${c}`):u?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${o}.0${c} <${i}.${+o+1}.0-0`),y("xRange return",n),n})},so=(r,e)=>(y("replaceStars",r,e),r.trim().replace(I[C.STAR],"")),io=(r,e)=>(y("replaceGTE0",r,e),r.trim().replace(I[e.includePrerelease?C.GTE0PRE:C.GTE0],"")),oo=r=>(e,t,n,s,i,o,a,c,l,u,d,E)=>(R(n)?t="":R(s)?t=`>=${n}.0.0${r?"-0":""}`:R(i)?t=`>=${n}.${s}.0${r?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,R(l)?c="":R(u)?c=`<${+l+1}.0.0-0`:R(d)?c=`<${l}.${+u+1}.0-0`:E?c=`<=${l}.${u}.${d}-${E}`:r?c=`<${l}.${u}.${+d+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),ao=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(y(r[n].semver),r[n].semver!==lt.ANY&&r[n].semver.prerelease.length>0){let s=r[n].semver;if(s.major===e.major&&s.minor===e.minor&&s.patch===e.patch)return!0}return!1}return!0}});var de=m((hl,pn)=>{var pe=Symbol("SemVer ANY"),pt=class r{static get ANY(){return pe}constructor(e,t){if(t=an(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),dt("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===pe?this.value="":this.value=this.operator+this.semver.version,dt("comp",this)}parse(e){let t=this.options.loose?cn[ln.COMPARATORLOOSE]:cn[ln.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new un(n[2],this.options.loose):this.semver=pe}toString(){return this.value}test(e){if(dt("Comparator.test",e,this.options.loose),this.semver===pe||e===pe)return!0;if(typeof e=="string")try{e=new un(e,this.options)}catch{return!1}return ut(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new dn(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new dn(this.value,t).test(e.semver):(t=an(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||ut(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||ut(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};pn.exports=pt;var an=Re(),{safeRe:cn,t:ln}=J(),ut=ot(),dt=le(),un=w(),dn=b()});var fe=m((ml,fn)=>{var co=b(),lo=(r,e,t)=>{try{e=new co(e,t)}catch{return!1}return e.test(r)};fn.exports=lo});var mn=m((gl,hn)=>{var uo=b(),po=(r,e)=>new uo(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));hn.exports=po});var En=m((El,gn)=>{var fo=w(),ho=b(),mo=(r,e,t)=>{let n=null,s=null,i=null;try{i=new ho(e,t)}catch{return null}return r.forEach(o=>{i.test(o)&&(!n||s.compare(o)===-1)&&(n=o,s=new fo(n,t))}),n};gn.exports=mo});var Tn=m((yl,yn)=>{var go=w(),Eo=b(),yo=(r,e,t)=>{let n=null,s=null,i=null;try{i=new Eo(e,t)}catch{return null}return r.forEach(o=>{i.test(o)&&(!n||s.compare(o)===1)&&(n=o,s=new go(n,t))}),n};yn.exports=yo});var wn=m((Tl,xn)=>{var ft=w(),To=b(),vn=ue(),vo=(r,e)=>{r=new To(r,e);let t=new ft("0.0.0");if(r.test(t)||(t=new ft("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let s=r.set[n],i=null;s.forEach(o=>{let a=new ft(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||vn(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!t||vn(t,i))&&(t=i)}return t&&r.test(t)?t:null};xn.exports=vo});var Cn=m((vl,Nn)=>{var xo=b(),wo=(r,e)=>{try{return new xo(r,e).range||"*"}catch{return null}};Nn.exports=wo});var Pe=m((xl,Sn)=>{var No=w(),Dn=de(),{ANY:Co}=Dn,Ro=b(),Io=fe(),Rn=ue(),In=be(),Do=Ae(),So=Oe(),bo=(r,e,t,n)=>{r=new No(r,n),e=new Ro(e,n);let s,i,o,a,c;switch(t){case">":s=Rn,i=Do,o=In,a=">",c=">=";break;case"<":s=In,i=So,o=Rn,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Io(r,e,n))return!1;for(let l=0;l<e.set.length;++l){let u=e.set[l],d=null,E=null;if(u.forEach(h=>{h.semver===Co&&(h=new Dn(">=0.0.0")),d=d||h,E=E||h,s(h.semver,d.semver,n)?d=h:o(h.semver,E.semver,n)&&(E=h)}),d.operator===a||d.operator===c||(!E.operator||E.operator===a)&&i(r,E.semver))return!1;if(E.operator===c&&o(r,E.semver))return!1}return!0};Sn.exports=bo});var On=m((wl,bn)=>{var Oo=Pe(),Ao=(r,e,t)=>Oo(r,e,">",t);bn.exports=Ao});var $n=m((Nl,An)=>{var $o=Pe(),Lo=(r,e,t)=>$o(r,e,"<",t);An.exports=Lo});var kn=m((Cl,Pn)=>{var Ln=b(),Po=(r,e,t)=>(r=new Ln(r,t),e=new Ln(e,t),r.intersects(e,t));Pn.exports=Po});var Un=m((Rl,qn)=>{var ko=fe(),qo=S();qn.exports=(r,e,t)=>{let n=[],s=null,i=null,o=r.sort((u,d)=>qo(u,d,t));for(let u of o)ko(u,e,t)?(i=u,s||(s=u)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);let a=[];for(let[u,d]of n)u===d?a.push(u):!d&&u===o[0]?a.push("*"):d?u===o[0]?a.push(`<=${d}`):a.push(`${u} - ${d}`):a.push(`>=${u}`);let c=a.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var Gn=m((Il,Mn)=>{var _n=b(),mt=de(),{ANY:ht}=mt,he=fe(),gt=S(),Uo=(r,e,t={})=>{if(r===e)return!0;r=new _n(r,t),e=new _n(e,t);let n=!1;e:for(let s of r.set){for(let i of e.set){let o=Vo(s,i,t);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},_o=[new mt(">=0.0.0-0")],Vn=[new mt(">=0.0.0")],Vo=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===ht){if(e.length===1&&e[0].semver===ht)return!0;t.includePrerelease?r=_o:r=Vn}if(e.length===1&&e[0].semver===ht){if(t.includePrerelease)return!0;e=Vn}let n=new Set,s,i;for(let h of r)h.operator===">"||h.operator===">="?s=Fn(s,h,t):h.operator==="<"||h.operator==="<="?i=jn(i,h,t):n.add(h.semver);if(n.size>1)return null;let o;if(s&&i){if(o=gt(s.semver,i.semver,t),o>0)return null;if(o===0&&(s.operator!==">="||i.operator!=="<="))return null}for(let h of n){if(s&&!he(h,String(s),t)||i&&!he(h,String(i),t))return null;for(let P of e)if(!he(h,String(P),t))return!1;return!0}let a,c,l,u,d=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,E=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let h of e){if(u=u||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",s){if(E&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===E.major&&h.semver.minor===E.minor&&h.semver.patch===E.patch&&(E=!1),h.operator===">"||h.operator===">="){if(a=Fn(s,h,t),a===h&&a!==s)return!1}else if(s.operator===">="&&!he(s.semver,String(h),t))return!1}if(i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator==="<"||h.operator==="<="){if(c=jn(i,h,t),c===h&&c!==i)return!1}else if(i.operator==="<="&&!he(i.semver,String(h),t))return!1}if(!h.operator&&(i||s)&&o!==0)return!1}return!(s&&l&&!i&&o!==0||i&&u&&!s&&o!==0||E||d)},Fn=(r,e,t)=>{if(!r)return e;let n=gt(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},jn=(r,e,t)=>{if(!r)return e;let n=gt(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};Mn.exports=Uo});var me=m((Dl,Bn)=>{var Et=J(),Hn=ce(),Fo=w(),Xn=rt(),jo=X(),Mo=gr(),Go=yr(),Ho=xr(),Xo=Cr(),Bo=Ir(),Wo=Sr(),zo=Or(),Ko=$r(),Yo=S(),Jo=qr(),Qo=_r(),Zo=Se(),ea=Mr(),ta=Hr(),ra=ue(),na=be(),sa=st(),ia=it(),oa=Oe(),aa=Ae(),ca=ot(),la=Zr(),ua=de(),da=b(),pa=fe(),fa=mn(),ha=En(),ma=Tn(),ga=wn(),Ea=Cn(),ya=Pe(),Ta=On(),va=$n(),xa=kn(),wa=Un(),Na=Gn();Bn.exports={parse:jo,valid:Mo,clean:Go,inc:Ho,diff:Xo,major:Bo,minor:Wo,patch:zo,prerelease:Ko,compare:Yo,rcompare:Jo,compareLoose:Qo,compareBuild:Zo,sort:ea,rsort:ta,gt:ra,lt:na,eq:sa,neq:ia,gte:oa,lte:aa,cmp:ca,coerce:la,Comparator:ua,Range:da,satisfies:pa,toComparators:fa,maxSatisfying:ha,minSatisfying:ma,minVersion:ga,validRange:Ea,outside:ya,gtr:Ta,ltr:va,intersects:xa,simplifyRange:wa,subset:Na,SemVer:Fo,re:Et.re,src:Et.src,tokens:Et.t,SEMVER_SPEC_VERSION:Hn.SEMVER_SPEC_VERSION,RELEASE_TYPES:Hn.RELEASE_TYPES,compareIdentifiers:Xn.compareIdentifiers,rcompareIdentifiers:Xn.rcompareIdentifiers}});var Ma={};Cs(Ma,{activate:()=>Fa,deactivate:()=>ja});module.exports=Rs(Ma);var O=require("vscode");function z(r){return'"'+r+'"'}function Ut(r){return r===void 0?!0:typeof r=="string"||Array.isArray(r)?r.length===0:typeof r=="object"&&r!==null?Object.keys(r).length===0:!1}var Be="abcdefghijklmnopqrstuvwxyz";function K(r){if(r<0||!Number.isInteger(r))throw new Error("Input must be a non-negative integer.");let e=Math.floor(r/Be.length),t=Be[r%Be.length];return"z".repeat(e)+t}var We=require("child_process");function _t(r){return new Promise((e,t)=>{let n=(0,We.exec)(r),s="",i="";n.stdout?.on("data",o=>{s+=o}),n.stderr?.on("data",o=>{i+=o}),n.on("exit",o=>{o===0?e(s):(console.log("child process error",i),t(new Error(i)))}),n.on("close",o=>{o===0?e(s):t(new Error(i||"Unknown error"))}),n.on("error",o=>{console.error("Failed to start subprocess:",o),t(o)})})}function Vt(r){return new Promise((e,t)=>{let n=(0,We.exec)(r),s="",i="";n.stdout?.on("data",o=>{o.startsWith("warning:")||(s+=o)}),n.stderr?.on("data",o=>{i+=o}),n.on("exit",o=>{e(s)}),n.on("close",o=>{o===0?e(s):t(new Error(i||"Unknown error"))}),n.on("error",o=>{console.error("Failed to start subprocess:",o),t(o)})})}function Ft(r){return/^[<>~=]/.test(r)&&r.includes("*")}var ne=require("vscode"),jt="crates-cmp",Mt="crates.sparse-index.url",Gt="cargo.audit.enable",ze=class{sparseIndexUrl="https://index.crates.io";enableAudit=!1;currentTheme;constructor(){this.updateSparseIndexUrl(),this.updateCargoAudit(),this.currentTheme=ne.window.activeColorTheme.kind}getSparseIndexUrl(){return this.sparseIndexUrl}getEnableAudit(){return this.enableAudit}getCurrentTheme(){return this.currentTheme}updateSparseIndexUrl(){let e=ne.workspace.getConfiguration("crates-cmp").get(Mt);typeof e=="string"&&(this.sparseIndexUrl=e)}updateCargoAudit(){let e=ne.workspace.getConfiguration("workbench.colorTheme").get(Gt);typeof e=="boolean"&&(this.enableAudit=e)}onThemeChange(e){this.currentTheme=e.kind}onChange(e){e.affectsConfiguration(jt+"."+Mt)&&this.updateSparseIndexUrl(),e.affectsConfiguration(jt+"."+Gt)&&this.updateCargoAudit()}},x=new ze;var se=class extends Error{constructor(e,t,n){let s=e.status||e.status===0?e.status:"",i=e.statusText||"",o=`${s} ${i}`.trim(),a=o?`status code ${o}`:"an unknown error";super(`Request failed with ${a}: ${t.method} ${t.url}`),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="HTTPError",this.response=e,this.request=t,this.options=n}};var Y=class extends Error{constructor(e){super(`Request timed out: ${e.method} ${e.url}`),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.request=e}};var ie=r=>r!==null&&typeof r=="object";var oe=(...r)=>{for(let e of r)if((!ie(e)||Array.isArray(e))&&e!==void 0)throw new TypeError("The `options` argument must be an object");return xe({},...r)},Ke=(r={},e={})=>{let t=new globalThis.Headers(r),n=e instanceof globalThis.Headers,s=new globalThis.Headers(e);for(let[i,o]of s.entries())n&&o==="undefined"||o===void 0?t.delete(i):t.set(i,o);return t},xe=(...r)=>{let e={},t={};for(let n of r)if(Array.isArray(n))Array.isArray(e)||(e=[]),e=[...e,...n];else if(ie(n)){for(let[s,i]of Object.entries(n))ie(i)&&s in e&&(i=xe(e[s],i)),e={...e,[s]:i};ie(n.headers)&&(t=Ke(t,n.headers),e.headers=t)}return e};var Ht=(()=>{let r=!1,e=!1,t=typeof globalThis.ReadableStream=="function",n=typeof globalThis.Request=="function";if(t&&n)try{e=new globalThis.Request("https://empty.invalid",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type")}catch(s){if(s instanceof Error&&s.message==="unsupported BodyInit type")return!1;throw s}return r&&!e})(),Xt=typeof globalThis.AbortController=="function",Bt=typeof globalThis.ReadableStream=="function",Wt=typeof globalThis.FormData=="function",we=["get","post","put","patch","head","delete"],Is=()=>{};Is();var zt={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},Ne=2147483647,Ce=Symbol("stop"),Kt={json:!0,parseJson:!0,stringifyJson:!0,searchParams:!0,prefixUrl:!0,retry:!0,timeout:!0,hooks:!0,throwHttpErrors:!0,onDownloadProgress:!0,fetch:!0},Yt={method:!0,headers:!0,body:!0,mode:!0,credentials:!0,cache:!0,redirect:!0,referrer:!0,referrerPolicy:!0,integrity:!0,keepalive:!0,signal:!0,window:!0,dispatcher:!0,duplex:!0,priority:!0};var Qt=r=>we.includes(r)?r.toUpperCase():r,Ds=["get","put","head","delete","options","trace"],Ss=[408,413,429,500,502,503,504],Zt=[413,429,503],Jt={limit:2,methods:Ds,statusCodes:Ss,afterStatusCodes:Zt,maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY,delay:r=>.3*2**(r-1)*1e3},er=(r={})=>{if(typeof r=="number")return{...Jt,limit:r};if(r.methods&&!Array.isArray(r.methods))throw new Error("retry.methods must be an array");if(r.statusCodes&&!Array.isArray(r.statusCodes))throw new Error("retry.statusCodes must be an array");return{...Jt,...r,afterStatusCodes:Zt}};async function Ye(r,e,t,n){return new Promise((s,i)=>{let o=setTimeout(()=>{t&&t.abort(),i(new Y(r))},n.timeout);n.fetch(r,e).then(s).catch(i).then(()=>{clearTimeout(o)})})}async function Je(r,{signal:e}){return new Promise((t,n)=>{e&&(e.throwIfAborted(),e.addEventListener("abort",s,{once:!0}));function s(){clearTimeout(i),n(e.reason)}let i=setTimeout(()=>{e?.removeEventListener("abort",s),t()},r)})}var tr=(r,e)=>{let t={};for(let n in e)!(n in Yt)&&!(n in Kt)&&!(n in r)&&(t[n]=e[n]);return t};var ae=class r{static create(e,t){let n=new r(e,t),s=async()=>{if(typeof n._options.timeout=="number"&&n._options.timeout>Ne)throw new RangeError(`The \`timeout\` option cannot be greater than ${Ne}`);await Promise.resolve();let a=await n._fetch();for(let c of n._options.hooks.afterResponse){let l=await c(n.request,n._options,n._decorateResponse(a.clone()));l instanceof globalThis.Response&&(a=l)}if(n._decorateResponse(a),!a.ok&&n._options.throwHttpErrors){let c=new se(a,n.request,n._options);for(let l of n._options.hooks.beforeError)c=await l(c);throw c}if(n._options.onDownloadProgress){if(typeof n._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!Bt)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return n._stream(a.clone(),n._options.onDownloadProgress)}return a},o=n._options.retry.methods.includes(n.request.method.toLowerCase())?n._retry(s):s();for(let[a,c]of Object.entries(zt))o[a]=async()=>{n.request.headers.set("accept",n.request.headers.get("accept")||c);let u=(await o).clone();if(a==="json"){if(u.status===204||(await u.clone().arrayBuffer()).byteLength===0)return"";if(t.parseJson)return t.parseJson(await u.text())}return u[a]()};return o}constructor(e,t={}){Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"abortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_retryCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._input=e;let n=this._input instanceof Request&&"credentials"in Request.prototype?this._input.credentials:void 0;if(this._options={...n&&{credentials:n},...t,headers:Ke(this._input.headers,t.headers),hooks:xe({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},t.hooks),method:Qt(t.method??this._input.method),prefixUrl:String(t.prefixUrl||""),retry:er(t.retry),throwHttpErrors:t.throwHttpErrors!==!1,timeout:t.timeout??1e4,fetch:t.fetch??globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(Xt){if(this.abortController=new globalThis.AbortController,this._options.signal){let s=this._options.signal;this._options.signal.addEventListener("abort",()=>{this.abortController.abort(s.reason)})}this._options.signal=this.abortController.signal}if(Ht&&(this._options.duplex="half"),this._options.json!==void 0&&(this._options.body=this._options.stringifyJson?.(this._options.json)??JSON.stringify(this._options.json),this._options.headers.set("content-type",this._options.headers.get("content-type")??"application/json")),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){let i="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),o=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,i);(Wt&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(o,{...this.request}),this._options)}}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<=this._options.retry.limit&&!(e instanceof Y)){if(e instanceof se){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;let n=e.response.headers.get("Retry-After");if(n&&this._options.retry.afterStatusCodes.includes(e.response.status)){let s=Number(n)*1e3;Number.isNaN(s)&&(s=Date.parse(n)-Date.now());let i=this._options.retry.maxRetryAfter??s;return s<i?s:i}if(e.response.status===413)return 0}let t=this._options.retry.delay(this._retryCount);return Math.min(this._options.retry.backoffLimit,t)}return 0}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(t){let n=Math.min(this._calculateRetryDelay(t),Ne);if(n!==0&&this._retryCount>0){await Je(n,{signal:this._options.signal});for(let s of this._options.hooks.beforeRetry)if(await s({request:this.request,options:this._options,error:t,retryCount:this._retryCount})===Ce)return;return this._retry(e)}throw t}}async _fetch(){for(let n of this._options.hooks.beforeRequest){let s=await n(this.request,this._options);if(s instanceof Request){this.request=s;break}if(s instanceof Response)return s}let e=tr(this.request,this._options),t=this.request;return this.request=t.clone(),this._options.timeout===!1?this._options.fetch(t,e):Ye(t,e,this.abortController,this._options)}_stream(e,t){let n=Number(e.headers.get("content-length"))||0,s=0;return e.status===204?(t&&t({percent:1,totalBytes:n,transferredBytes:s},new Uint8Array),new globalThis.Response(null,{status:e.status,statusText:e.statusText,headers:e.headers})):new globalThis.Response(new globalThis.ReadableStream({async start(i){let o=e.body.getReader();t&&t({percent:0,transferredBytes:0,totalBytes:n},new Uint8Array);async function a(){let{done:c,value:l}=await o.read();if(c){i.close();return}if(t){s+=l.byteLength;let u=n===0?0:s/n;t({percent:u,transferredBytes:s,totalBytes:n},l)}i.enqueue(l),await a()}await a()}}),{status:e.status,statusText:e.statusText,headers:e.headers})}};var Qe=r=>{let e=(t,n)=>ae.create(t,oe(r,n));for(let t of we)e[t]=(n,s)=>ae.create(n,oe(r,s,{method:t}));return e.create=t=>Qe(oe(t)),e.extend=t=>Qe(oe(r,t)),e.stop=Ce,e},bs=Qe(),Ze=bs;var ge=H(me());async function yt(r){let e=x.getSparseIndexUrl(),t=r.replace(/"/g,"").toLocaleLowerCase(),n="";t.length<=2?n=t.length.toString():t.length===3?n="3/"+t.substring(0,1):n=t.substring(0,2)+"/"+t.substring(2,4);let s=await Ze.get(`${e}/${n}/${t}`);if(s.status!==200)throw new Error(`${s.status}`);let i=(await s.text()).split(`
`).filter(E=>E),o=[],a={},c={},l=[],u=null,d=null;for(let E=i.length-1;E>=0;E--){let h=JSON.parse(i[E]);if(h.yanked===!1){o.push(h.vers),u===null&&(0,ge.prerelease)(h.vers)===null?u=h.vers:d===null&&(0,ge.prerelease)(h.vers)!==null&&(d=h.vers),h.rust_version&&(c[h.vers]=h.rust_version);let P=Object.keys(h.features).filter(re=>re==="default"?(l=h.features.default,!1):!0),kt=[];h.features2&&(kt=Object.keys(h.features2)),a[h.vers]=[...P,...kt];for(let re of h.deps)re.optional&&(0,ge.satisfies)(h.vers,re.req)&&a[h.vers].push(re.name)}}return{name:r,versions:o,features:a,defaultFeatures:l,rustVersion:c,createdAt:new Date().getUTCMilliseconds(),latestStable:u,latestPrerelease:d}}async function Wn(r){if(r==="")return[];let e=await Ze.get("https://crates.io/api/v1/crates?page=1&per_page=30&q="+r,{headers:{"User-Agent":"VSCodeExtension/crates-cmp"}});if(e.status!==200)throw new Error(`search crate error: statusCode=${e.status} ${await e.text()}`);return(await e.json()).crates}async function q(r,e,t=!1){let n=Ca(e);if(t){let i=await yt(e).catch(o=>{throw o});return r.globalState.update(n,i),i}let s=r.globalState.get(n);if(!s||s.createdAt>new Date().getUTCMilliseconds()-1e3*60*10){let i=await yt(e).catch(o=>{throw o});return r.globalState.update(n,i),i}return s}function Ca(r){return`crates-cmp:metadata:${r}`}async function zn(r,e){return(await q(r,e)).versions}var Ee=Symbol("None"),ye=class r{val;constructor(e){this.val=e}get[Symbol.toStringTag](){return"Option"}*[Symbol.iterator](){this.isSome()&&(yield this.val)}isSome(){return this.val!==Ee}isNone(){return this.val===Ee}expect(e){if(this.isNone())throw new Error(e);return this.val}unwrap(){if(this.isNone())throw new Error("Unwrap called on None");return this.val}unwrapOr(e){return this.isNone()?e:this.val}unwrapOrElse(e){return this.isNone()?e():this.val}map(e){return this.isSome()?new r(e(this.val)):this}mapOr(e,t){return this.isSome()?t(this.val):e}or(e){return this.isSome()?this:e}okOr(e){return this.isSome()?Z(this.val):ee(e)}peek(){return this.val}flatten(){return this.val instanceof r?this.val:this}static from(e){let t=e();return t==null?new r(Ee):new r(t)}static async fromAsync(e){let t=await e();return t==null?new r(Ee):new r(t)}};function ke(r){return new ye(r)}Object.defineProperty(ke,Symbol.hasInstance,{value:r=>typeof r!="object"?!1:r?.isSome()||!1});function qe(){return new ye(Ee)}Object.defineProperty(qe,Symbol.hasInstance,{value:r=>typeof r!="object"?!1:r?.isNone()||!1});var te=class r{val;constructor(e){this.val=e}get[Symbol.toStringTag](){return"Result"}*[Symbol.iterator](){this.isOk()&&(yield this.val)}isOk(){return!(this.val instanceof Error||this.val&&typeof this.val=="object"&&Error.isPrototypeOf(this.val))}isErr(){return this.val instanceof Error||this.val&&typeof this.val=="object"&&Error.isPrototypeOf(this.val)}formatError(e){throw e.stack=`${e.message}: ${this.val.stack?`
	`+this.val.stack.split(`
`).join(`
	`):this.val.message}`,e}expect(e){return this.isErr()&&this.formatError(new Error(e)),this.val}expectErr(e){return this.isOk()&&this.formatError(new Error(e)),this.val}unwrap(){return this.isErr()&&this.formatError(new Error(`Unwrap called on ${this.val.name}`)),this.val}unwrapErr(){if(this.isOk())throw new Error(`UnwrapError called on value - ${this.val}`);return this.val}unwrapOr(e){return this.isErr()?e:this.val}unwrapOrElse(e){return this.isErr()?e(this.val):this.val}map(e){return this.isOk()?new r(e(this.val)):this}mapErr(e){return this.isOk()?this:new r(e(this.val))}mapOr(e,t){return this.isOk()?t(this.val):e}or(e){return this.isOk()?this:e}ok(){return this.isOk()?ke(this.val):qe()}peek(){return this.val}throw(){if(this.isErr())throw this.val}flatten(){return this.val instanceof r?this.val:this}static from(e){try{return new r(e())}catch(t){return new r(t)}}static async fromAsync(e){try{return new r(await e())}catch(t){return new r(t)}}static partition(e){return e.reduce((t,n)=>(n.isOk()?t.ok.push(n.unwrap()):t.err.push(n.unwrapErr()),t),{ok:[],err:[]})}};function Z(r){return new te(r)}Object.defineProperty(Z,Symbol.hasInstance,{value:r=>typeof r!="object"?!1:r?.isOk()||!1});function ee(r){return typeof r=="string"?new te(new Error(r)):new te(r)}Object.defineProperty(ee,Symbol.hasInstance,{value:r=>typeof r!="object"?!1:r?.isErr()||!1});async function N(r){try{let e=await r;return Z(e)}catch(e){return ee(e)}}var Kn=H(me());async function Yn(r,e,t,n){if(e==="")return[];let s=await N(q(r,e));if(s.isErr())throw s.unwrapErr();let i=s.unwrap();if(t==="")return i.features[i.latestStable]??[];let o=Ra(i,t);if(o.length===0)return[];if(n&&n.length!==0){let a={};for(let c of n)a[c]=!0;return o.filter(c=>!a[c])}return o}function Ra(r,e){let t=r.features[e]??[];if(t.length===0){for(let n of r.versions)if((0,Kn.satisfies)(n,e)){t=r.features[n]??[];break}}return t}var U=H(me());function Jn(r,e){if(e.length===0)return[];let t=[];for(let n of e)t.push(Ia(r,n));return t}async function Ia(r,e){let t=await q(r.extensionContext,e.name);t[e.version.value]||(t=await q(r.extensionContext,e.name,!0));let n={state:"Unknown",...e.version};if((0,U.prerelease)(n.installed)===null){if(n.installed!==t.latestStable){if(n.latest=t.latestStable,(0,U.major)(n.installed)===(0,U.major)(t.latestStable))return n.state="Outdated",{ctx:r,version:n};for(let s of t.versions)if((0,U.satisfies)(s,n.installed))return n.currentMax=s,n.currentMax===n.installed?n.state="Locked":n.state="LockandNotOutdated",{ctx:r,version:n}}return n.state="Latest",n.latest=t.latestStable,{ctx:r,version:n}}if(n.installed!==t.latestPrerelease){if(n.state="Outdated",n.latest=t.latestPrerelease,(0,U.satisfies)(t.latestPrerelease,n.installed))return{ctx:r,version:n};for(let s of t.versions)if((0,U.satisfies)(s,n.installed))return n.currentMax=s,n.currentMax===n.installed?n.state="Locked":n.state="LockandNotOutdated",{ctx:r,version:n};return{ctx:r,version:n}}return n.state="Latest",n.latest=t.latestPrerelease,{ctx:r,version:n}}async function Qn(r){return Wn(r)}var _=H(me()),B=require("vscode");async function Zn(r,e){if(e.length===0)return[];let t=[];for await(let n of e){let s=await N(q(r.extensionContext,n.name,!1));if(s.isErr())return s.unwrapErr().message.startsWith("Request failed with status code 404 Not Found:")?[{ctx:r,crate:{id:n.id,dependencyId:n.id,value:n.name,severity:B.DiagnosticSeverity.Error,message:"Crate not found",source:"extension/crates-cmp"}}]:(console.log("Sparse index request err: ",s.unwrapErr()),[]);let i=s.unwrap(),o,a=(0,_.minVersion)(n.version.value);if(!a)return[];let c=!1;if((0,_.prerelease)(a)!==null&&(c=!0),!c&&(0,_.gt)(a,i.latestStable))return[{ctx:r,version:{latest:i.latestStable,state:"NotExist",diagnostic:{severity:B.DiagnosticSeverity.Error,source:"extension/crates-cmp",message:"Version not found, latest stable is "+i.latestStable},...n.version}}];if(c&&!i.latestPrerelease)return[{ctx:r,version:{latest:i.latestStable,state:"NotExist",diagnostic:{severity:B.DiagnosticSeverity.Error,source:"extension/crates-cmp",message:"Prerelease not found, latest stable is "+i.latestStable},...n.version}}];if(c&&(0,_.gt)(a,i.latestPrerelease))return[{ctx:r,version:{latest:i.latestPrerelease,state:"NotExist",diagnostic:{severity:B.DiagnosticSeverity.Error,source:"extension/crates-cmp",message:"Prerelease not found, latest prelease is "+i.latestStable},...n.version}}];for(let l of i.versions){let u=n.version.value;if(Ft(u)||(u="^"+u),l===n.version.value||(0,_.satisfies)(l,u)){o=l;break}}if(!o)return[{ctx:r,version:{latest:i.latestStable,state:"NotExist",diagnostic:{severity:B.DiagnosticSeverity.Error,source:"extension/crates-cmp",message:"Version not found, latest stable is "+i.latestStable},...n.version}}];if(o&&n.features.length!==0){for(let l of n.features)if(!i.features[o].includes(l.value))return[{ctx:r,feature:{state:"NotExist",diagnostic:{severity:B.DiagnosticSeverity.Error,source:"extension/crates-cmp",message:`Feature "${l.value}" not found, available features are `+i.features[o].join(", ")},...l}}]}}return[]}function es(r){let e=r.split(`
`),t={dependencies:{},"build-dependencies":{},"dev-dependencies":{},duplicated:new Map},n="dependencies";function s(a){let c=a.trim();c==="[build-dependencies]"?n="build-dependencies":c==="[dev-dependencies]"&&(n="dev-dependencies")}function i(a){let c=!1,l=!1,u,d=a.trim().split(/\s+/);if(d.length<3)return null;let E=d[1],h=d[2].startsWith("v")?d[2].substring(1):d[2];for(let P of d.slice(3))P==="(*)"?c=!0:P==="(proc-macro)"?l=!0:P.startsWith("(")&&P.endsWith(")")&&(u=P.slice(1,-1));return{name:E,version:h,path:u,procMacro:l,deduplicated:c}}let o=new Map;e.forEach(a=>{if(s(a),n&&(a.trim().startsWith("\u251C\u2500\u2500")||a.trim().startsWith("\u2514\u2500\u2500"))){let c=i(a);c&&(t[n][c.name]=c,o.has(c.name)?o.get(c.name).add(c.version):o.set(c.name,new Set([c.version])))}});for(let[a,c]of o)c.size>1&&t.duplicated.set(a,Array.from(c));return t}var vt=class{path=void 0;dependencies=new Map;dirtyNodes=new Map;notFoundNodes=new Set;localDepNodes=new Set;isEmpty(){return this.dependencies.size===0}checkAndDelDirty(e,t){return this.dirtyNodes.has(e)&&this.dirtyNodes.get(e)<=t?(this.dirtyNodes.delete(e),!0):!1}reset(){this.dependencies.clear(),this.dirtyNodes.clear(),this.notFoundNodes.clear(),this.localDepNodes.clear()}init(e,t){e!==this.path&&(this.dependencies.clear(),this.dirtyNodes.clear(),this.notFoundNodes.clear())}getDependencies(){return this.dependencies}populateUserInput(e,t,n){for(let s of[...n.added,...n.valueUpdated]){let i=t[s];i&&(this.dependencies.set(s,{...i}),this.dirtyNodes.set(s,e))}for(let s of n.deleted)this.dependencies.delete(s)}populateCurrent(e,t){for(let s of this.dirtyNodes.keys()){if(!this.dirtyNodes.get(s))continue;let i=this.dependencies.get(s),o=i.packageName??i.name,a=t[i.table][o]??void 0;if(a.path){this.localDepNodes.add(s);continue}if(!a){this.notFoundNodes.add(s);continue}this.dependencies.set(s,{...i,version:{...i.version,installed:a.version,dependencyId:s}})}let n=[];if(t.duplicated.size!==0)for(let[s,i]of this.dependencies.entries()){let o=i.packageName??i.name;t.duplicated.has(o)&&n.push({rangeId:i.version.id,dependencyId:s,crates:t.duplicated.get(o)})}return n}populateCurrentWithoutDoc(e,t){for(let s of this.dependencies.values()){let i=s.packageName??s.name,o=t[s.table][i]??void 0;o&&(o.path||s.version.installed!==o.version&&(this.dependencies.set(s.id,{...s,version:{...s.version,installed:t[s.table][i].version,dependencyId:s.id}}),this.dirtyNodes.set(s.id,e)))}let n=[];if(t.duplicated.size!==0)for(let[s,i]of this.dependencies.entries()){let o=i.packageName??i.name;t.duplicated.has(o)&&n.push({rangeId:i.version.id,dependencyId:s,crates:t.duplicated.get(o)})}return n}dirtyIds(){return Array.from(this.dirtyNodes.keys())}isClean(){return this.dirtyNodes.size===0}notFoundIds(){return Array.from(this.notFoundNodes)}localDepIds(){return Array.from(this.localDepNodes)}dirtyDeps(e=0){let t=[];for(let[n,s]of this.dirtyNodes.entries()){if(s>e)return[];let i=this.dependencies.get(n);t.push(i)}return t}dependency(e){return this.dependencies.get(e)}updateVersion(e,t){let n=this.dependencies.get(e);n&&this.dependencies.set(e,{...n,version:t})}updateFeature(e,t){let n=this.dependencies.get(e);if(n){for(let s=0;s<n.features.length;s++)if(n.features[s].id===t.id){n.features[s]=t;break}}}invalidCrate(e){let t=this.dependencies.get(e);t&&this.dependencies.set(e,{...t,invalid:!0})}},ts=new vt;var F=require("vscode");async function xt(r,e,t){let n=await N(zn(r,e));if(n.isErr())return F.window.showErrorMessage(n.unwrapErr().message),[];let s=n.unwrap().map((i,o)=>{let a=new F.CompletionItem(z(i),F.CompletionItemKind.Constant);return a.insertText=z(i),a.sortText=K(o++),a.preselect=o===0,a.range=t,a});return new F.CompletionList(s)}var j=require("vscode");async function rs(r,e,t,n,s){let i=await N(Yn(r,e,t,n));if(i.isErr())return j.window.showErrorMessage(i.unwrapErr().message),[];let o=i.unwrap().map((a,c)=>{let l=new j.CompletionItem(z(a),j.CompletionItemKind.Constant);return l.insertText=z(a),l.sortText=K(c++),l.preselect=c===0,l.range=s,l});return new j.CompletionList(o)}var V=require("vscode");async function ns(r,e){let t=Sa(r,e),n=await N(Qn(t));if(n.isErr())return V.window.showErrorMessage(n.unwrapErr().message),[];let[s,i]=ba(t);return n.unwrap().map((a,c)=>{let l=new V.CompletionItem(a.name,V.CompletionItemKind.Constant);return l.insertText=a.name,l.documentation=a.description,l.detail="max version: "+a.max_version,l.sortText=K(c++),l.preselect=c===0,l.range=new V.Range(e.line,s,e.line,i),l})}function Sa(r,e){let t=new V.Range(e.line,0,e.line,e.character);return r.getText(t)}function ba(r){let e=-1,t=-1;for(let n=0;n<r.length;n++)r[n].trim()!==""&&(e===-1&&(e=n),t=n);return[e,t]}var ss=require("vscode");function is(r,e){return new Promise((t,n)=>{ss.commands.executeCommand(r,e).then(s=>{Ut(s)&&n("symbol provider unavailable"),t(s)},s=>n(s))})}var cs=require("vscode");var os=require("vscode");function A(r){return r&&new os.Range(r.start.translate(0,1),r.end.translate(0,-1))}function as(r){return new Promise(e=>setTimeout(e,r))}var wt=class{enterTable(e,t){return!0}enterDependencies(e,t){return!0}onPackage(e,t){}onDependencies(e,t,n,s){}onFeatures(e,t){}onWorkspace(e,t){}onLib(e,t){}onBin(e,t){}onProfile(e,t){}onBadges(e,t){}onOther(e,t){}tree;constructor(e){this.tree=e}walk(){for(let e of this.tree)switch(e.name){case"package":this.enterTable(e,"package")&&this.onPackage(e.name,e);break;case"dependencies":this.enterDependencies(e,"dependencies")&&this.onDependencies(e.name,e,"dependencies");break;case"dev-dependencies":this.enterDependencies(e,"dev-dependencies")&&this.onDependencies(e.name,e,"dev-dependencies");break;case"build-dependencies":this.enterDependencies(e,"build-dependencies")&&this.onDependencies(e.name,e,"build-dependencies");break;case"target":if(this.enterDependencies(e,"dependencies"))for(let t of e.children)for(let n of t.children)this.onDependencies(W(e.name,t.name,n.name),n,"dependencies",t.name);case"features":this.enterTable(e,"features")&&this.onFeatures(e.name,e);break;case"workspace":this.enterTable(e,"workspace")&&this.onWorkspace(e.name,e);break;case"lib":this.enterTable(e,"lib")&&this.onLib(e.name,e);break;case"bin":this.enterTable(e,"bin")&&this.onBin(e.name,e);break;case"profile":this.enterTable(e,"profile")&&this.onProfile(e.name,e);break;case"badges":this.enterTable(e,"badges")&&this.onBadges(e.name,e);break;default:this.enterTable(e,"other")&&this.onOther(e.name,e);break}}},Te=class extends wt{enterCrate(e){return!0}onCrate(e,t,n,s){}onDependencies(e,t,n,s){for(let i of t.children)this.enterCrate(i)&&this.onCrate(W(e,i.name),i,n,s)}};async function _e(r){for(let e=0;e<5;e++){let t=await N(is("vscode.executeDocumentSymbolProvider",r));if(console.log("waiting for Even better toml"),t.isOk())return t.unwrap();await as(500)}return cs.window.showErrorMessage("Require `Even Better TOML` extension"),[]}var Ue=class extends Te{identifiers=[];doc;docTree;constructor(e,t,n){super(e),this.doc=t,this.docTree=n}enterTable(e,t){return!1}enterDependencies(e,t){return!0}enterCrate(e){return!0}onCrate(e,t,n,s){let i=t.name,o={id:e,name:i,version:{id:"",value:"",dependencyId:""},features:[],table:n,platform:s},a=[],c=this.doc.getText(t.range).replace(/(\r\n|\r|\n)/g,">");if(this.docTree.visitDependency(o.id,c,t.range),this.docTree.visitNode(o.id,{id:e,table:n,range:t.range,value:c,dependency:{dependencyId:o.id,key:"crate"}}),a.push(o.id),t.children.length===0){let l=this.doc.getText(A(t.range));o.version={id:e,value:l,dependencyId:e},this.docTree.visitNode(o.id,{id:e,table:n,range:t.range,value:c,dependency:{dependencyId:o.id,key:"simpleVersion"}}),this.docTree.addDependency(o),this.docTree.setRnages(t.range,a);return}for(let l of t.children){if(l.name==="version"){let u=this.doc.getText(A(l.range)),d=W(o.id,l.name);o.version={id:d,value:u,dependencyId:o.id},this.docTree.visitNode(d,{id:d,table:n,value:u,range:l.range,dependency:{dependencyId:o.id,key:"version"}}),a.push(d);continue}if(l.name==="features"){if(l.children.length!==0)for(let u of l.children){let d=this.doc.getText(A(u.range)),E=W(o.id,l.name,u.name);this.docTree.visitNode(E,{id:E,table:n,value:d,range:u.range,dependency:{dependencyId:o.id,key:"feature"}}),o.features.push({id:E,value:d,dependencyId:o.id}),a.push(E)}else{let u=this.doc.getText(A(l.range)),d=W(o.id,l.name);this.docTree.visitNode(d,{id:d,table:n,value:u,range:l.range,dependency:{dependencyId:o.id,key:"feature"}}),o.features.push({id:d,value:u,dependencyId:o.id}),a.push(d)}continue}if(l.name==="package"){let u=W(o.id,l.name),d=this.doc.getText(A(l.range));o.packageName=d,this.docTree.visitNode(u,{id:u,table:n,value:d,range:l.range,dependency:{dependencyId:o.id,key:"package"}}),a.push(u)}if(l.name==="path"){let u=W(o.id,l.name),d=this.doc.getText(A(l.range));o.path={id:u,dependencyId:o.id,value:d},this.docTree.visitNode(u,{id:u,table:n,value:d,range:l.range,dependency:{dependencyId:o.id,key:"path"}}),a.push(u)}}this.docTree.addDependency(o),this.docTree.setRnages(t.range,a)}};function W(...r){return r.join(".")}var Ve=class{context;constructor(e){this.context=e}provideCompletionItems(e,t,n,s){return new Promise(async i=>{let o=await this.completionItems(e,t,n,s);i(o)})}async completionItems(e,t,n,s){let i=await _e(e.uri);if(i.length===0)return[];let o=new Nt(i,t);if(o.walk(),!o.crateName)return await ns(e,t);if(o.versionNode&&o.versionNode.range.contains(t))return await xt(this.context,o.crateName,o.versionNode.range);if(o.featuresNode&&o.featuresNode.children.length!==0){if(o.featuresNode.range.contains(t)){let a=e.getText(A(o.versionNode?.range)),c,l=[];for(let u of o.featuresNode.children){if(u.range.contains(t)){c=u.range;continue}l.push(e.getText(A(u.range)))}return await rs(this.context,o.crateName,a,l,c)}return[]}return o.isComplexDependencyBlock?[]:await xt(this.context,o.crateName,o.crateRange)}},Nt=class extends Te{isComplexDependencyBlock=!1;crateName;crateRange;versionNode;featuresNode;position;constructor(e,t){super(e),this.position=t}enterTable(e,t){return!1}enterDependencies(e,t){return!!e.range.contains(this.position)}enterCrate(e){return!!e.range.contains(this.position)}onCrate(e,t){if(this.crateName=t.name,this.crateRange=t.range,t.children.length!==0){this.isComplexDependencyBlock=!0;for(let n of t.children){if(n.name==="version"){this.versionNode=n;continue}if(n.name==="features"){this.featuresNode=n;continue}}}this.enterCrate=n=>!1}};var ms=require("vscode");var D=require("vscode");var T=require("vscode"),Ct=class{path;state;constructor(){this.state={}}init(e){if(this.path!==e){this.state={},this.path=e;return}}reset(){this.state={},this.path=void 0}delete(e){this.state[e]&&(this.state[e].decoration.dispose(),delete this.state[e])}get(e){return this.state[e]}set(e,t){this.state[e]=t}decorateDependency(e,t,n){if(n===void 0){let o=this.get(e);o&&T.window.activeTextEditor?.setDecorations(o.decoration,[t]);return}let s=this.get(e);s&&s.decoration.dispose();let i=Aa(n);this.set(e,{decoration:i}),T.window.activeTextEditor?.setDecorations(i,[t])}setLoading(e,t){t!==void 0&&this.decorateDependency(e,t,{text:"Waiting...",color:"grey"})}setNotInstalled(e,t){t!==void 0&&this.decorateDependency(e,t,{text:"Not Installed",color:"grey"})}setLocalDep(e,t){t!==void 0&&this.decorateDependency(e,t,{text:"Local",color:"grey"})}},us=new Ct;function Aa(r){return T.window.createTextEditorDecorationType({after:{contentText:r.text,color:r.color,margin:"0 0 0 4em"}})}function ds(r){switch(r.state){case"Latest":return{text:"\u2705 "+r.latest,color:$a()};case"Outdated":return{text:"\u2B06\uFE0F "+r.installed+"==>"+r.latest,color:La()};case"Locked":return{text:"\u{1F512} "+r.installed+", "+r.latest,color:ls()};case"LockandNotOutdated":return{text:"\u{1F512} "+r.installed+"==>"+r.currentMax+", "+r.latest,color:ls()}}}function $a(){switch(x.getCurrentTheme()){case T.ColorThemeKind.Light:return"#006400";case T.ColorThemeKind.HighContrastLight:return"#006400";case T.ColorThemeKind.Dark:return"green";case T.ColorThemeKind.HighContrast:return"green"}}function La(){switch(x.getCurrentTheme()){case T.ColorThemeKind.Light:return"#FF8C00";case T.ColorThemeKind.HighContrastLight:return"#FF8C00";case T.ColorThemeKind.Dark:return"yellow";case T.ColorThemeKind.HighContrast:return"yellow"}}function ls(){switch(x.getCurrentTheme()){case T.ColorThemeKind.Light:return"#B8860B";case T.ColorThemeKind.HighContrastLight:return"#B8860B";case T.ColorThemeKind.Dark:return"orange";case T.ColorThemeKind.HighContrast:return"orange"}}var ps=require("vscode"),Rt=class{collection;state=new Map;constructor(){this.collection=ps.languages.createDiagnosticCollection("crates-cmp")}add(e,t){let n=this.state.get(e);if(n){n.set(t.id,t);return}let s=new Map;s.set(t.id,t),this.state.set(e,s)}delete(e,t){let n=this.state.get(e.path);if(n&&n.delete(t)){let i=Array.from(n.values()).map(o=>o.diagnostic);this.collection.set(e,i)}}render(e){let t=this.state.get(e.path);if(t){let n=Array.from(t.values()).map(s=>s.diagnostic);this.collection.set(e,n)}else this.collection.set(e,void 0)}clear(e,t){let n=this.state.get(e.path);if(n){if(!t){n.clear(),this.render(e);return}for(let[s,i]of n)i.state.equal(t)&&n.delete(s);this.render(e)}}};var M=class{state="Unkown";constructor(e){this.state=e}getState(){return this.state}equal(e){return this.state===e.getState()}},Fe=new Rt;var It=class{path="";nodes=new Map;notVisitedNode=new Set;dependencyNodes={};rangeStore=new Dt;added=new Set;valueUpdated=new Set;rangeUpdated=new Set;dependencyIds=[];deleted=new Set;setRnages(e,t){this.rangeStore.set(e.start.line,e.end.line,t)}isEmpty(){return this.nodes.size===0}reset(){this.path="",this.nodes.clear(),this.notVisitedNode.clear(),this.dependencyNodes={},this.added.clear(),this.valueUpdated.clear(),this.rangeUpdated.clear(),this.dependencyIds.length=0,this.deleted.clear()}init(e){if(this.rangeStore.clear(),this.dependencyNodes={},this.path!==e){this.nodes.clear(),this.path=e,this.added.clear(),this.valueUpdated.clear(),this.rangeUpdated.clear(),this.deleted.clear(),this.dependencyIds.length=0;return}this.added.clear(),this.valueUpdated.clear(),this.rangeUpdated.clear(),this.deleted.clear();for(let t of this.nodes.keys())this.notVisitedNode.add(t);for(let t of this.dependencyIds)this.deleted.add(t);this.dependencyIds.length=0}visitDependency(e,t,n){this.dependencyIds.push(e),this.deleted.delete(e);let s=this.nodes.get(e);s?(s.value!==t&&this.valueUpdated.add(e),s.range.isEqual(n)||this.rangeUpdated.add(e)):this.added.add(e)}addDependency(e){this.dependencyNodes[e.id]=e}visitNode(e,t){this.notVisitedNode.delete(e),this.nodes.set(e,t)}finalize(){for(let e of this.notVisitedNode)this.nodes.delete(e);return this.dependencyNodes}deletedIds(){return Array.from(this.deleted)}dirtyIds(){return[...this.added,...this.valueUpdated]}isClean(){return this.dirtyIds().length===0}rangeUpdatedIds(){return Array.from(this.rangeUpdated)}node(e){return this.nodes.get(e)}nodeFromRange(e){let t=this.rangeStore.ids(e.start.line);if(t)for(let n=t.length-1;n>=0;n--){let s=t[n],i=this.node(s);if(i&&i.range.isSingleLine&&i.range.start.line===e.start.line&&i.range.start.isBefore(e.start)&&i.range.end.isAfter(e.end))return i}}range(e){let t=this.nodes.get(e);return t?t.range:void 0}getAllChanges(){return{added:Array.from(this.added),valueUpdated:Array.from(this.valueUpdated),rangeUpdated:Array.from(this.rangeUpdated),deleted:Array.from(this.deleted)}}},Dt=class{ranges=new Map;set(e,t,n){for(let s=e;s<=t;s++)this.ranges.set(s,n)}clear(){this.ranges.clear()}ids(e){return this.ranges.get(e)}},fs=new It;var $=H(require("vscode")),je=H(require("path")),Me=H(require("os")),St={};async function bt(){let r={RUST_BACKTRACE:"short"};return Object.assign(r,process.env),r.RUSTC_TOOLCHAIN?"cargo":Pa("cargo")}async function Pa(r){return St[r]||(St[r]=ka(r)),St[r]}async function ka(r){let e=process.env[r.toUpperCase()];if(e)return e;if(await qa(r))return r;let t=Ua();if(t){let n=$.Uri.joinPath(t,"bin",r);if(await hs(n))return n.fsPath}return r}async function qa(r){let t=(process.env.PATH?.split(je.delimiter)||[]).flatMap(n=>{let s=je.join(n,r);return Me.type()==="Windows_NT"?[s,`${s}.exe`]:[s]});return(await Promise.all(t.map(_a))).some(Boolean)}function Ua(){let r=process.env.CARGO_HOME;if(r)return $.Uri.file(r);try{return $.Uri.joinPath($.Uri.file(Me.homedir()),".cargo")}catch(e){return console.error("Failed to read the fs info",e),null}}async function _a(r){return hs($.Uri.file(r))}async function hs(r){try{return((await $.workspace.fs.stat(r)).type&$.FileType.File)!==0}catch{return!1}}async function Ot(r){let e=await bt(),t=await _t(`${e} tree --manifest-path ${r} --depth 1 --all-features`).catch(n=>{throw n});return es(t)}async function Ge(r){let e=await bt(),t=await Vt(`${e} audit --json -f ${r}`).catch(n=>{throw n});return JSON.parse(t)}var At=class{docTree=fs;depTree=ts;decorations=us;diagnostic=Fe;path;version=0;rev=0;reset(){this.path=void 0,this.docTree.reset(),this.depTree.reset(),this.decorations.reset()}init(e){this.path!==e.uri.path&&(this.rev=0),this.path=e.uri.path,this.docTree.init(this.path),this.decorations.init(this.path),this.version=e.version}async parseDocument(e,t){let n=await _e(t.uri);if(this.noResumeDocTree())return;let s={extensionContext:e,path:this.path,rev:this.incRev(),uri:t.uri};new Ue(n,t,this.docTree).walk();let o=this.docTree.finalize();if(this.docTree.isEmpty())return;for(let u of this.docTree.dirtyIds())this.decorations.setLoading(u,this.docTree.range(u)),this.diagnostic.delete(s.uri,u);for(let u of this.docTree.deletedIds())this.decorations.delete(u),this.diagnostic.delete(s.uri,u);for(let u of this.docTree.rangeUpdatedIds())this.decorations.decorateDependency(u,this.docTree.range(u));if(this.docTree.isClean())return;this.depTree.populateUserInput(s.rev,o,this.docTree.getAllChanges());let a=await N(Ot(s.path));if(this.noResumeDepTree())return;if(a.isErr())return await this.afterCargoErr(s);let c=a.unwrap(),l=this.depTree.populateCurrent(s.rev,c);this.afterCargoOk(s,l)}async afterCargoErr(e){let t=this.depTree.dirtyDeps(this.rev);if(t.length===0)return;let n=await Zn(e,t);n.length!==0&&(n.filter(s=>{let i=s.version?.dependencyId??s.feature?.dependencyId??s.crate.dependencyId;return this.depTree.checkAndDelDirty(i,s.ctx.rev)}).forEach(s=>{let i="",o="",a="",c=D.DiagnosticSeverity.Hint;s.crate&&(i=s.crate.id,o=s.crate.id,a=s.crate.message,c=s.crate.severity,this.depTree.invalidCrate(i)),s.version&&(i=s.version.dependencyId,o=s.version.id,a=s.version.diagnostic.message,c=s.version.diagnostic.severity,this.depTree.updateVersion(s.version.dependencyId,s.version)),s.feature&&(i=s.feature.dependencyId,o=s.feature.id,a=s.feature.diagnostic.message,c=s.feature.diagnostic.severity,this.depTree.updateFeature(s.feature.dependencyId,s.feature)),this.decorations.delete(i),this.diagnostic.add(s.ctx.path,{id:i,state:new M("Dependency"),diagnostic:new D.Diagnostic(this.docTree.range(o),a,c)})}),this.diagnostic.render(e.uri))}afterCargoOk(e,t){if(t.length!==0){for(let i of t)this.diagnostic.add(e.path,{id:i.dependencyId,state:new M("Dependency"),diagnostic:new D.Diagnostic(this.docTree.range(i.rangeId),`Found multiple versions: ${i.crates.join(", ")}`,D.DiagnosticSeverity.Information)});this.diagnostic.render(e.uri)}else this.diagnostic.clear(e.uri,new M("Dependency"));for(let i of this.depTree.notFoundIds())this.depTree.checkAndDelDirty(i,e.rev)&&this.decorations.setNotInstalled(i,this.docTree.range(i));for(let i of this.depTree.localDepIds())this.depTree.checkAndDelDirty(i,e.rev)&&this.decorations.setLocalDep(i,this.docTree.range(i));let n=this.depTree.dirtyDeps(this.rev);if(n.length===0)return;Jn(e,n).forEach(i=>i.then(this.outputPromiseHandler.bind(this)))}async parseDependencies(e,t){if(!this.depTree.isClean())return;let n={extensionContext:e,path:this.path,rev:this.incRev(),uri:t.uri},s=await N(Ot(n.path));if(this.noResumeDepTree())return;if(s.isErr())return await this.afterCargoErr(n);let i=s.unwrap(),o=this.depTree.populateCurrentWithoutDoc(n.rev,i);for(let a of this.depTree.dirtyIds())this.decorations.setLoading(a,this.docTree.range(a)),this.diagnostic.delete(n.uri,a);this.afterCargoOk(n,o)}outputPromiseHandler(e){if(this.depTree.checkAndDelDirty(e.version.dependencyId,e.ctx.rev)){let t=ds(e.version);if(!t)return;this.depTree.updateVersion(e.version.dependencyId,e.version),this.decorations.decorateDependency(e.version.dependencyId,this.docTree.range(e.version.dependencyId),t)}}incRev(){return this.rev=this.rev+1,this.rev}noResumeDocTree(){if(!D.window.activeTextEditor||(D.window.activeTextEditor.document.fileName.endsWith("Cargo.toml"),D.window.activeTextEditor.document.uri.path!==this.path)||D.window.activeTextEditor.document.version<this.version)return!0}noResumeDepTree(){if(!D.window.activeTextEditor||(D.window.activeTextEditor.document.fileName.endsWith("Cargo.toml"),D.window.activeTextEditor.document.uri.path!==this.path)||this.depTree.isEmpty())return!0}nodeFromRange(e){return this.docTree.nodeFromRange(e)}dependency(e){return this.depTree.dependency(e)}},He=new At;var v=require("vscode");var $t=class{initialized=!1;state=new Map;diagnostic;constructor(e){this.diagnostic=e}async initialize(){if(!x.getEnableAudit()||this.initialized)return;let e=await v.workspace.findFiles("**/Cargo.lock");for await(let t of e){let n=await Ge(t.path);this.state.set(t.path,n)}this.initialized=!0,this.updateDiagnostic()}async onLockFileChange(e){if(!x.getEnableAudit())return;let t=await Ge(e.path);this.state.set(e.path,t),this.updateDiagnostic()}async onLockFileCreate(e){if(!x.getEnableAudit())return;let t=await Ge(e.path);this.state.set(e.path,t),this.updateDiagnostic()}async onLockFileDelete(e){x.getEnableAudit()&&(this.state.delete(e.path),this.updateDiagnostic())}updateDiagnostic(){if(!v.window.activeTextEditor||!v.window.activeTextEditor.document.fileName.endsWith("Cargo.toml"))return;let e=v.window.activeTextEditor.document.uri.path,t=v.DiagnosticSeverity.Hint,n="";for(let[s,i]of this.state){if(n+=`File: ${s} 

`,i?.vulnerabilities.found){n+=`Vulnerabilities found: ${i.vulnerabilities.count} 

`,t=v.DiagnosticSeverity.Error;for(let o of i.vulnerabilities.list)o?.advisory&&(n+=`ID: ${o.advisory.id}
Package: ${o.advisory.package}
title: ${o.advisory.title}
url: ${o.advisory.url}

`)}if(i?.warnings?.unsound&&i.warnings.unsound.length>0){t!==v.DiagnosticSeverity.Error&&(t=v.DiagnosticSeverity.Warning),n+=`Unsound found: ${i.warnings.unsound.length} 

`;for(let o of i.warnings.unsound)o?.advisory&&(n+=`ID: ${o.advisory.id}
Package: ${o.advisory.package}
title: ${o.advisory.title}
url: ${o.advisory.url}

`)}if(i?.warnings?.yanked&&i.warnings.yanked.length>0){t!==v.DiagnosticSeverity.Error&&(t=v.DiagnosticSeverity.Warning),n+=`Yanked found: ${i.warnings.yanked.length} 

`;for(let o of i.warnings.yanked)n+=`Package: ${o.package.name}
version: ${o.package.version}
`}n+=`
`}t!==v.DiagnosticSeverity.Hint&&(this.diagnostic.add(e,{id:"package",state:new M("Audit"),diagnostic:{message:n,range:new v.Range(0,1,0,10),severity:t}}),this.diagnostic.render(v.window.activeTextEditor.document.uri))}},G=new $t(Fe);var Xe=class{ctx;state=He;constructor(e){this.ctx=e}async onDidSaveTextDocument(e){e.fileName.endsWith("Cargo.toml")&&(this.state.init(e),await this.state.parseDocument(this.ctx,e))}async onDidChangeActiveEditor(e){this.state.path!==void 0&&this.state.reset(),e&&e.document.fileName.endsWith("Cargo.toml")&&(this.state.init(e.document),await this.state.parseDocument(this.ctx,e.document))}async onDidLockFileChange(e){G.onLockFileChange(e),!this.state.noResumeDepTree()&&await this.state.parseDependencies(this.ctx,ms.window.activeTextEditor.document)}onDidCloseTextDocument(e){e.fileName.endsWith("Cargo.toml")&&e.uri.path===this.state.path&&this.state.reset()}};var gs=require("vscode"),Lt=class{client=void 0;dependencies={};async init(){let e=gs.extensions.getExtension("rust-lang.rust-analyzer");if(!e)throw new Error("Require Rust Analyzer");let t=await e.activate();if(!t.client)throw new Error("Require Rust Analyzer");t.client.start(),this.client=t.client}stop(){if(this.client)return this.client.stop()}async dependencyList(){let e=await this.client?.sendRequest("rust-analyzer/fetchDependencyList",{});for(let t of e.crates)this.dependencies[t.name]=t}dependency(e){return this.dependencies[e]}languageClient(){return this.client}},Es=new Lt;var L=require("vscode");var Pt=class{state=He;static providedCodeActionKinds=[L.CodeActionKind.RefactorRewrite];provideCodeActions(e,t){let n=this.state.nodeFromRange(t);if(n&&n.dependency){let s=this.state.dependency(n.dependency?.dependencyId),i=[];switch(n.dependency.key){case"simpleVersion":case"version":switch(s?.version.state??"Unknown"){case"NotExist":let a=new L.CodeAction(s.version.latest,L.CodeActionKind.QuickFix);a.edit=new L.WorkspaceEdit,a.edit.replace(e.uri,n.range,'"'+s.version.latest+'"'),i.push(a);break;case"Outdated":let c=new L.CodeAction(s.version.latest,L.CodeActionKind.RefactorRewrite);c.edit=new L.WorkspaceEdit,c.edit.replace(e.uri,n.range,'"'+s.version.latest+'"'),i.push(c);break}}return i}}},ys=new Pt;async function Fa(r){let e={language:"toml",pattern:"**/Cargo.toml"};O.workspace.onDidChangeConfiguration(x.onChange,x);let t=new Xe(r);G.initialize();let n=O.workspace.createFileSystemWatcher("**/Cargo.lock");r.subscriptions.push(O.window.onDidChangeActiveColorTheme(x.onThemeChange,x),O.window.onDidChangeActiveTextEditor(t.onDidChangeActiveEditor,t),O.workspace.onDidSaveTextDocument(t.onDidSaveTextDocument,t),O.workspace.onDidCloseTextDocument(t.onDidCloseTextDocument,t),n.onDidChange(t.onDidLockFileChange,t),n.onDidCreate(G.onLockFileCreate,G),n.onDidDelete(G.onLockFileDelete,G),O.languages.registerCodeActionsProvider(e,ys),O.languages.registerCompletionItemProvider(e,new Ve(r),'"',".","+","-","0","1","2","3","4","5","6","7","8","9"))}function ja(){return Es.stop()}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

ky/distribution/index.js:
  (*! MIT License © Sindre Sorhus *)
*/
